<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OPaS - Digit√°lny Podpis</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #D60000;
            --gray-100: #F3F4F6;
            --gray-200: #E5E7EB;
            --gray-700: #374151;
            --gray-900: #111827;
            --success: #16a34a;
        }

        body { 
            background-color: #cbd5e1; 
            font-family: 'Roboto', sans-serif; 
            margin: 0; padding: 0; 
            display: flex; justify-content: center; 
        }

        .app-container { 
            display: grid; 
            grid-template-columns: 350px 210mm; 
            gap: 20px; 
            padding: 20px; 
            margin: 0 auto;
        }

        /* OVL√ÅDAC√ç PANEL */
        .controls { 
            background: white; padding: 20px; border-radius: 8px; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); height: fit-content;
            position: sticky; top: 10px; font-size: 13px;
        }

        .form-group { margin-bottom: 8px; display: flex; flex-direction: column; gap: 2px; }
        label { font-size: 9px; font-weight: 700; color: var(--gray-700); text-transform: uppercase; }
        input, select, textarea { padding: 6px; border: 1px solid var(--gray-200); border-radius: 4px; font-size: 11px; }
        .btn-print { width: 100%; background: var(--primary); color: white; border: none; padding: 12px; border-radius: 4px; font-weight: 700; cursor: pointer; margin-top: 10px; text-transform: uppercase; }

        /* === DOKUMENT A4 === */
        .a4-page {
            width: 210mm;
            height: 297mm;
            background: white;
            padding: 10mm 15mm;
            box-sizing: border-box;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* HLAVIƒåKA */
        .header { 
            border-bottom: 2px solid var(--primary); 
            padding-bottom: 5px; margin-bottom: 10px; 
            display: flex; justify-content: space-between; align-items: flex-end;
        }
        .brand h1 { color: var(--primary); margin: 0; font-size: 24px; font-weight: 900; }
        .brand .sub { font-size: 9px; color: #333; margin-top: 2px; }
        .report-meta { text-align: right; }
        .report-type { font-size: 14px; font-weight: 800; text-transform: uppercase; color: #000; line-height: 1.2; }
        .report-no { font-size: 12px; margin-top: 3px; }

        /* INFO BOXY */
        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }
        .box { border: 1px solid #ccc; padding: 6px; }
        .box-title { font-size: 8px; font-weight: 700; text-transform: uppercase; color: #666; border-bottom: 1px solid #eee; margin-bottom: 4px; padding-bottom: 2px; }
        .box-content { font-size: 11px; line-height: 1.3; }
        .row-item { display: flex; justify-content: space-between; margin-bottom: 2px; }
        .row-item strong { font-weight: 600; }

        .section-header { background: #eee; padding: 4px 8px; font-weight: 700; font-size: 10px; text-transform: uppercase; margin-top: 8px; border-left: 3px solid var(--primary); }

        /* TABUƒΩKA */
        .data-table { width: 100%; border-collapse: collapse; margin-top: 5px; }
        .data-table th, .data-table td { border: 1px solid #ccc; padding: 4px 6px; font-size: 10px; text-align: left; }
        .data-table th { background: #f9f9f9; font-weight: 700; }

        /* P√ÑTA A PODPISY */
        .footer-area { margin-top: auto; }
        .legal-small { font-size: 8px; color: #555; text-align: justify; margin-bottom: 10px; line-height: 1.2; }
        
        .status-box { 
            margin: 10px auto; border: 2px solid var(--success); padding: 6px; 
            text-align: center; font-size: 13px; font-weight: 800; color: var(--success); 
            width: 80%; border-radius: 0; background: #f0fdf4; text-transform: uppercase;
        }

        .signatures { display: flex; justify-content: space-between; align-items: flex-end; margin-top: 5px; }
        .sig-box { width: 32%; text-align: center; position: relative; }
        .sig-line { border-top: 1px solid #000; margin-top: 5px; font-size: 9px; padding-top: 2px; font-weight: 700; }

        /* KANVAS A UPLOAD */
        canvas#cust-sig-canvas {
            border: 1px dashed #ccc;
            cursor: crosshair;
            background: #fff;
            touch-action: none; /* D√¥le≈æit√© pre dotykov√© obrazovky */
        }
        
        .sig-controls {
            margin-top: 2px;
            font-size: 9px;
            display: flex;
            justify-content: center;
            gap: 5px;
        }

        button.small-btn {
            background: #eee; border: 1px solid #ccc; padding: 2px 5px; cursor: pointer; font-size: 9px; border-radius: 3px;
        }
        button.small-btn:hover { background: #ddd; }

        .tech-sig-img {
            max-width: 140px;
            max-height: 60px;
            object-fit: contain;
            display: block;
            margin: 0 auto;
        }

        input[type="file"] { display: none; }
        .upload-label {
            background: #e0e7ff; color: #3730a3; padding: 2px 6px; border-radius: 3px; cursor: pointer; font-size: 9px; display: inline-block; margin-bottom: 2px;
        }

        @media print {
            body { background: white; }
            .app-container { display: block; width: 100%; margin: 0; padding: 0; }
            .controls, .sig-controls, .upload-label { display: none !important; } /* Skryje tlaƒçidl√° pri tlaƒçi */
            canvas { border: none !important; } /* Skryje r√°mik pri tlaƒçi */
            .a4-page { margin: 0 auto; box-shadow: none; width: 210mm; height: 297mm; }
            @page { size: A4; margin: 0; }
        }
    </style>
</head>
<body>

<div class="app-container">
    <section class="controls">
        <h2 style="margin-top:0; font-size:14px; color:var(--primary)">Nastavenia Rev√≠zie</h2>
        
        <div class="form-group"><label>ƒå√≠slo spr√°vy</label><input type="text" id="inp-no" value="OPaS-2026/001"></div>
        <div class="form-group"><label>D√°tum v√Ωkonu</label><input type="date" id="inp-date"></div>
        
        <hr style="border:0; border-top:1px solid #eee; margin:5px 0">
        <div class="form-group"><label>Prev√°dzkovateƒæ</label><input type="text" id="inp-name" placeholder="Firma / Meno"></div>
        <div class="form-group"><label>Adresa</label><input type="text" id="inp-addr"></div>
        
        <hr style="border:0; border-top:1px solid #eee; margin:5px 0">
        <div class="form-group"><label>Zariadenie</label><input type="text" id="inp-dev" placeholder="Napr. Plynov√Ω kotol Viessmann"></div>
        <div class="form-group"><label>Merac√≠ pr√≠stroj</label><input type="text" id="inp-tool" value="Testo 330-2 LL"></div>

        <button class="btn-print" onclick="window.print()">üñ®Ô∏è Tlaƒçi≈• Dokument</button>
    </section>

    <section class="preview-container">
        <div class="a4-page">
            <div class="header">
                <div class="brand">
                    <h1>SPEKTRA INSTALL</h1>
                    <div class="sub">
                        Holl√©ho 210, 015 01 Rajec | IƒåO: 53690036 | DPH: 23%<br>
                        Opr√°vnenie na ƒçinnos≈• ƒç.: OPO-0000/2020
                    </div>
                </div>
                <div class="report-meta">
                    <div class="report-type">SPR√ÅVA O ODBORNEJ PREHLIADKE<br>A ODBORNEJ SK√ö≈†KE PLYNOV√âHO ZARIADENIA</div>
                    <div class="report-no" id="out-no">ƒå√≠slo: OPaS-2026/001</div>
                </div>
            </div>

            <div class="info-grid">
                <div class="box">
                    <div class="box-title">PREV√ÅDZKOVATEƒΩ / OBJEDN√ÅVATEƒΩ</div>
                    <div class="box-content">
                        <div class="row-item"><span>N√°zov/Meno:</span> <strong id="out-name">J√°n Nov√°k</strong></div>
                        <div class="row-item"><span>Adresa:</span> <span id="out-addr">Miesto in≈°tal√°cie</span></div>
                        <div class="row-item"><span>IƒåO:</span> <span>-</span></div>
                    </div>
                </div>
                <div class="box">
                    <div class="box-title">REVIZNY TECHNIK / ORGANIZ√ÅCIA</div>
                    <div class="box-content">
                        <div class="row-item"><span>Meno:</span> <strong>Pavol Pastorek</strong></div>
                        <div class="row-item"><span>Osvedƒçenie ƒç.:</span> <strong>1234/5/2023</strong></div>
                        <div class="row-item"><span>Evidenƒçn√© ƒç.:</span> <span>SPE-26-001</span></div>
                    </div>
                </div>
            </div>

            <div class="info-grid">
                <div class="box">
                    <div class="box-title">TECHNICK√â ZARIADENIE (VTZ)</div>
                    <div class="box-content">
                        <div class="row-item"><span>N√°zov:</span> <strong id="out-dev">Plynov√Ω kotol</strong></div>
                        <div class="row-item"><span>V√Ωr. ƒç√≠slo:</span> <span>123456789</span></div>
                        <div class="row-item"><span>Zatriedenie:</span> <strong>Skupina Bh (do 0,5 MW)</strong></div>
                    </div>
                </div>
                <div class="box">
                    <div class="box-title">√öDAJE O PREHLIADKE</div>
                    <div class="box-content">
                        <div class="row-item"><span>Druh:</span> <strong>Periodick√°</strong></div>
                        <div class="row-item"><span>D√°tum:</span> <strong id="out-date">13. 02. 2026</strong></div>
                        <div class="row-item"><span>Pr√≠stroj:</span> <span id="out-tool">Testo 330</span></div>
                    </div>
                </div>
            </div>

            <div class="section-header">1. V√Ωsledky meran√≠ a sk√∫≈°ok</div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th style="width:40%">Predmet merania</th>
                        <th style="width:20%">Norma</th>
                        <th style="width:20%">Nameran√©</th>
                        <th style="width:20%">Hodnotenie</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Tlak plynu na vstupe</td><td>1.8 - 2.5 kPa</td><td><strong>2.1 kPa</strong></td><td>Vyhovuje</td></tr>
                    <tr><td>Tesnos≈• spojov (detektor)</td><td>0 ppm</td><td><strong>0 ppm</strong></td><td>Vyhovuje</td></tr>
                    <tr><td>Koncentr√°cia CO</td><td>max. 100 ppm</td><td><strong>14 ppm</strong></td><td>Vyhovuje</td></tr>
                    <tr><td>≈§ah kom√≠na / Teplota</td><td>min. 3 Pa</td><td><strong>12 Pa / 45¬∞C</strong></td><td>Vyhovuje</td></tr>
                    <tr><td>Funkcia blok. prvkov</td><td>&lt; 1s</td><td><strong>0.5s</strong></td><td>Vyhovuje</td></tr>
                    <tr><td>Tlak v syst√©me</td><td>1.0 - 2.0 bar</td><td><strong>1.5 bar</strong></td><td>Vyhovuje</td></tr>
                    <tr><td>Vizu√°lna kontrola</td><td>podƒæa TPP</td><td><strong>Bez z√°vad</strong></td><td>Vyhovuje</td></tr>
                </tbody>
            </table>

            <div class="section-header">2. Celkov√© hodnotenie</div>
            <div style="font-size:10px; margin-top:5px; text-align:justify;">
                Zariadenie nevykazuje vady br√°niace bezpeƒçnej prev√°dzke. V≈°etky bezpeƒçnostn√© prvky s√∫ funkƒçn√©.
                Zariadenie <strong>JE SP√îSOBIL√â</strong> bezpeƒçnej prev√°dzky v zmysle Vyhl√°≈°ky 508/2009 Z.z.
                ƒéal≈°ia prehliadka do: <strong>13. 02. 2027</strong>.
            </div>

            <div class="footer-area">
                <div class="legal-small">
                    Tento doklad je √∫radn√Ωm z√°znamom v zmysle ¬ß 9 z√°kona ƒç. 124/2006 Z. z. Prev√°dzkovateƒæ je povinn√Ω uchov√°va≈• t√∫to spr√°vu do nasleduj√∫cej prehliadky.
                </div>

                <div class="status-box">ZARIADENIE JE SP√îSOBIL√â NA ƒéAL≈†IU PREV√ÅDZKU</div>

                <div class="signatures">
                    <div class="sig-box">
                        <div style="height: 60px; display:flex; align-items:flex-end; justify-content:center;">
                            <strong id="out-date-sig" style="font-size:12px;">13. 02. 2026</strong>
                        </div>
                        <div class="sig-line">D√°tum vyhotovenia</div>
                    </div>

                    <div class="sig-box">
                        <canvas id="cust-sig-canvas" width="180" height="60"></canvas>
                        <div class="sig-controls">
                            <button class="small-btn" onclick="clearCanvas()">Vymaza≈•</button>
                            <span style="color:#999; font-size:8px; line-height:16px;">(Podp√≠≈°te tu)</span>
                        </div>
                        <div class="sig-line">Podpis prev√°dzkovateƒæa</div>
                    </div>

                    <div class="sig-box">
                        <div style="height: 60px; display: flex; align-items: flex-end; justify-content: center;">
                            <img id="tech-sig-preview" class="tech-sig-img" src="" alt="Peƒçiatka">
                        </div>
                        <div class="sig-controls">
                            <label for="tech-sig-upload" class="upload-label">üìÇ Nahra≈• peƒçiatku</label>
                            <input type="file" id="tech-sig-upload" accept="image/*" onchange="loadTechSig(event)">
                        </div>
                        <div class="sig-line">
                            <strong>Pavol Pastorek</strong><br>Rev√≠zny technik
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<script>
    // --- Z√ÅKLADN√Å LOGIKA VYKRESLOVANIA ---
    function render() {
        document.getElementById('out-no').textContent = "ƒå√≠slo: " + document.getElementById('inp-no').value;
        document.getElementById('out-name').textContent = document.getElementById('inp-name').value || "‚Äî";
        document.getElementById('out-addr').textContent = document.getElementById('inp-addr').value || "‚Äî";
        document.getElementById('out-dev').textContent = document.getElementById('inp-dev').value || "‚Äî";
        document.getElementById('out-tool').textContent = document.getElementById('inp-tool').value;

        const dVal = document.getElementById('inp-date').value;
        if(dVal) {
            const d = new Date(dVal);
            const dateStr = `${d.getDate()}. ${(d.getMonth()+1).toString().padStart(2, '0')}. ${d.getFullYear()}`;
            document.getElementById('out-date').textContent = dateStr;
            document.getElementById('out-date-sig').textContent = dateStr;
        }
    }

    // --- PODPIS Z√ÅKAZN√çKA (CANVAS) ---
    const canvas = document.getElementById('cust-sig-canvas');
    const ctx = canvas.getContext('2d');
    let drawing = false;

    // Nastavenie pre lep≈°ie kreslenie
    ctx.lineWidth = 2;
    ctx.lineCap = 'round';
    ctx.strokeStyle = '#000';

    function startPosition(e) {
        drawing = true;
        draw(e);
    }
    function endPosition() {
        drawing = false;
        ctx.beginPath();
    }
    function draw(e) {
        if (!drawing) return;
        e.preventDefault(); // Zabr√°ni scrollovaniu na mobile

        const rect = canvas.getBoundingClientRect();
        const x = (e.clientX || e.touches[0].clientX) - rect.left;
        const y = (e.clientY || e.touches[0].clientY) - rect.top;

        ctx.lineTo(x, y);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x, y);
    }

    // Event Listenery (My≈°)
    canvas.addEventListener('mousedown', startPosition);
    canvas.addEventListener('mouseup', endPosition);
    canvas.addEventListener('mousemove', draw);

    // Event Listenery (Dotyk - Mobil/Tablet)
    canvas.addEventListener('touchstart', startPosition);
    canvas.addEventListener('touchend', endPosition);
    canvas.addEventListener('touchmove', draw);

    function clearCanvas() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    // --- NAHRANIE PEƒåIATKY TECHNIKA ---
    function loadTechSig(event) {
        const reader = new FileReader();
        reader.onload = function(){
            document.getElementById('tech-sig-preview').src = reader.result;
        }
        reader.readAsDataURL(event.target.files[0]);
    }

    // Init
    document.getElementById('inp-date').value = new Date().toISOString().split('T')[0];
    document.querySelectorAll('input, select').forEach(el => el.addEventListener('input', render));
    render();
</script>

</body>
</html>
